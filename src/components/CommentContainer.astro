---
import CommentCard from "@components/CommentCard.astro";
import { client } from "@utils/contentful_utils";

const { key, data } = Astro.props;

const { id: id, title: title } = data.fields;

const commentCards = await Promise.all(
    data.fields.commentsCards.map(async (comment: { sys: { id: string } }) => {
        const commentId = comment.sys.id;
        const commentData = await client.getEntry(commentId);
        return commentData;
    })
);
---

<section class="comment-container">
    <h2 class="section-title">{title}</h2>
    <div class="card-container">
        <div class="card-wrapper">
            {
                commentCards &&
                    commentCards.length > 0 &&
                    commentCards.map(
                        (
                            comment: {
                                fields: {
                                    id: string;
                                    title: string;
                                    body: string;
                                    jobAndCompany: string;
                                };
                            },
                            index: number
                        ) =>
                            comment?.fields && (
                                <CommentCard key={index} data={comment} />
                            )
                    )
            }
            {
                commentCards &&
                    commentCards.length > 0 &&
                    commentCards.map(
                        (
                            comment: {
                                fields: {
                                    id: string;
                                    title: string;
                                    body: string;
                                    jobAndCompany: string;
                                };
                            },
                            index: number
                        ) =>
                            comment?.fields && (
                                <CommentCard
                                    key={index + commentCards.length}
                                    data={comment}
                                />
                            )
                    )
            }
        </div>
    </div>
</section>

<style>
    .comment-container {
        max-width: 100%;
        margin: 0 auto;
        padding: 16px;
    }

    .section-title {
        text-align: center;
        margin-bottom: 1rem;
    }

    .card-container {
        overflow: hidden;
        position: relative;
        width: 90%;
    }

    .card-wrapper {
        display: flex;
        gap: 16px;
        animation: scrollAnimation 15s linear infinite;
        width: max-content;
    }

    /* Pausar animaci√≥n al pasar el mouse */
    .card-container:hover .card-wrapper {
        animation-play-state: paused;
    }

    @keyframes scrollAnimation {
        0% {
            transform: translateX(0);
        }
        100% {
            transform: translateX(calc(-50% - 16px));
        }
    }
</style>
